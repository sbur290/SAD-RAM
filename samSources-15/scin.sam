/*testscin.sam, version 13, Feb, 2023
 Test row scan operations. File generated by sam.exe is loaded into BRAM.
 Try inserting recorsd into row 24, which contains 11 records at the start.
*/

#include <stdHeaders.sam>
    $shocode;                                                       //
start:                                                              //
    $bug    = 2;                                                    //
    $curRow = 0;                                                    //[0] contains configuration vector
    $bug_indx;                                                      //display configuration vector
    cfg(cell);                                                      //configure cells
    cfg(group);                                                     //configure groups
    $curRow = 24;            $bug_indx;                             //last (partially filled) hINDX[]
    scin(indx) "7CB42901";   $bug_indx;                             //ok inserted at 0x40
    scin(indx) "7AC20124";   $bug_indx;                             //ok inserted at 0x20
    scin(indx) "7B4401CF";   $bug_indx;                             //ok inserted at 0x40; row 24 is now full
    scin(indx) "7A619125";   $bug_indx;                             //Should report samStatus=Full and not do the insert
    if (full)                                                       //
       {print "line=$line, pc=$pc: Insert 0x$0 failed\n";           //
        PUSHALL;                                                    //
        call mitosis;                                               //
        POPALL;                                                     //
        scin(indx);                                                 //restart the operation
        stop;                                                       //
       }                                                            //
                                                                    //
mitosis: print "line=$line, pc=$pc: Start mitosis\n"; ret;          //

//end of file...
 